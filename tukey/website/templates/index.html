{% load static %}
<!DOCTYPE html>
<html lang="pt-br">

<head>
    <title>Teste de Tukey</title>
    <meta charset="utf-8">
    <meta name="author" content="Till Duo">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
</head>

<body>
    <div class="container">
        <h1>Teste de Tukey</h1>

        <div>
            <form action="{% url 'create_table' %}" id="create_table" name="create_table">
                {% csrf_token %}
                <center>
                    <table class="table">
                        <thead>
                            <h4>Dados Iniciais</h4>
                        </thead>
                        <tr>
                            <th scope="row">Tratamentos (k)</th>
                            <td>
                                <input class="form-control" type="number" id="k" name="k" min="1" value="{{ k }}"
                                    required></th>
                            <td>
                        </tr>
                        <tr>
                            <th scope="row">Repetições (n)</th>
                            <td><input class="form-control" type="number" id="n" name="n" min="2" value="{{ n }}"
                                    required></td>
                        </tr>
                        <tr>
                            <th scope="row">Alfa</th>
                            <td><input class="form-control" type="text" id="alfa" name="alfa" value="{{ alfa }}"
                                    list="alfalist" required></td>
                        </tr>
                        {% for item in items %}
                        <tr>
                            <th scope="row">GL{{ forloop.counter }}</th>
                            <td>
                                <center>{{ item }}</center>
                            </td>
                        </tr>
                        {% endfor %}
                        <tr>
                            <th scope="row">Q</th>
                            <td>
                                <p {% if q == "Valor desconhecido" %} style="color:red" {% endif %}> {{ q }} </p>
                            </td>
                        </tr>
                    </table>
                    <button class="btn btn-primary" type="submit">Gerar tabela de tratamentos</button>
                </center>
            </form>
            <datalist id="alfalist">
                <option value="0.001">
                <option value="0.005">
                <option value="0.01">
                <option value="0.025">
                <option value="0.05">
                <option value="0.1">
            </datalist>
        </div>

        <hr>
        <hr>

        <div>
            <form action="{% url 'calcule_tukey' %}" id="calcule_tukey">
                {% csrf_token %}
                <center>
                    <table class="table">
                        </thead>
                        <h4>Tratamentos</h4>
                        </thead>
                        {% for row in table %}
                        <tr>
                            {% for cell in row %} {% if forloop.first or forloop.parentloop.first %}
                            <th scope="row">
                                {% else %}
                            <td>
                                {% endif %} {% if forloop.first or forloop.parentloop.first %} {{ cell }}
                                </th>
                                {% else %}

                                <input value="{{ cell }}" type="number" step="0.25" min="0"
                                    id="cell_{{ forloop.parentloop.counter|add:'-2' }}_{{ forloop.counter|add:'-2' }}"
                                    name="cell_{{ forloop.parentloop.counter|add:'-2' }}_{{ forloop.counter|add:'-2' }}">
                            </td>
                            {% endif %} {% endfor %}
                        </tr>
                        {% endfor %}
                        <tr>
                            <th scope="row">Média</th>
                            {% for value in average %}
                            <td>{{ value }}</td>
                            {% endfor %}
                        </tr>

                        <tr>
                            <th scope="row">Variância</th>
                            {% for value in variance %}
                            <td>{{ value }}</td>
                            {% endfor %}
                        </tr>

                        <tr>
                            <th scope="row">MQ Dentro</th>
                            <td>{{ mq_in }}</td>
                        </tr>

                        <tr>
                            <th scope="row">HSD</th>
                            <td>{{ hsd }}</td>
                        </tr>
                    </table>
                    <button class="btn btn-primary" type="submit"> Calcular </button>
                    <center>
            </form>
        </div>
        <hr>
        <hr>
        <div>
            <table class="table">
                </thead>
                <h4>Diferenças das Médias</h4>
                </thead>
                {% for row in table_differences %}
                <tr>
                    {% for cell in row %} {% if forloop.first or forloop.parentloop.first %}
                    <th scope="row">
                        {% else %}
                    <td>
                        {% endif %} {% if forloop.first or forloop.parentloop.first %} {{ cell }}
                        </th>
                        {% else %} {% if cell > hsd %}
                        <p style="color: green"
                            id="cell_diff_{{ forloop.parentloop.counter|add:'-2' }}_{{ forloop.counter|add:'-2' }}"
                            name="cell_diff_{{ forloop.parentloop.counter|add:'-2' }}_{{ forloop.counter|add:'-2' }}">
                            {{cell}}
                        </p>
                        {% else %}
                        <p style="color: red"
                            id="cell_diff_{{ forloop.parentloop.counter|add:'-2' }}_{{ forloop.counter|add:'-2' }}"
                            name="cell_diff_{{ forloop.parentloop.counter|add:'-2' }}_{{ forloop.counter|add:'-2' }}">
                            {{cell}}
                        </p>
                        {% endif %}

                    </td>
                    {% endif %} {% endfor %}
                </tr>
                {% endfor %}
            </table>
            <table class="table">
                <tr>
                    <th scope="row">Média</th>
                    {% for value in descending_averages %}
                    <td>{{ value }}</td>
                    {% endfor %}
                </tr>
                <tr>
                    <th scope="row">Código</th>
                    {% for row in codes%} {% for value in row %}
                    <td>{{ value }}</td>
                    {% endfor %} {% endfor %}
                </tr>
            </table>
        </div>
    </div>
</body>

</html>